<div class="timeline-grid-container">
  <!-- Left Panel: Work Centers -->
  <div class="work-centers-panel">
    <div class="work-center-header">Work Center</div>
    @for (workCenter of workCenters; track workCenter) {
      <div class="work-center-row">
        <div class="work-center-name">{{ workCenter }}</div>
      </div>
    }
  </div>

  <!-- Right Panel: Timeline Grid (Scrollable) -->
  <div class="timeline-panel" #timelinePanel>
    <!-- Timeline Header -->
    <div class="timeline-header">
      @for (date of dateHeaders(); track date.getTime()) {
        <div class="timeline-month-header" [class.current-month]="isCurrentMonth(date)">
          <div class="month-name">{{ formatDateHeader(date) }}</div>
        </div>
      }
    </div>

    <!-- Timeline Rows -->
    @for (workCenter of workCenters; track workCenter; let i = $index) {
      <div 
        class="timeline-row"
        [style.width.px]="containerWidth()"
        (click)="onRowClick($event, workCenter)"
      >
        <!-- Vertical lines overlay -->
        <div class="vertical-lines">
          @for (date of dateHeaders(); track date.getTime(); let j = $index) {
            <div 
              class="vertical-line"
              [class.current-month]="j === getCurrentMonthIndex()"
              [style.left.px]="j * 150"
            ></div>
          }
        </div>
        
        <!-- Current month label (only on first row, first cell of current month) -->
        @if (i === 0) {
          @if (getCurrentMonthIndex() >= 0) {
            <div class="current-month-label" [style.left.px]="getCurrentMonthIndex() * 150 + 8">
              Current month
            </div>
          }
        }
        
        <!-- Work order bars for this work center (positioned absolutely) -->
        @for (workOrder of getWorkOrdersForCenter(workCenter); track workOrder.docId) {
          <app-work-order-bar
            [workOrder]="workOrder"
            [left]="getBarLeft(workOrder)"
            [width]="getBarWidth(workOrder)"
            (edit)="onEditWorkOrder($event)"
            (delete)="onDeleteWorkOrder($event)"
          />
        }
      </div>
    }
  </div>
</div>
